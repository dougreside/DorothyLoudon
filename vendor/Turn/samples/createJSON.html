<!doctype html>
<html>
<head>
<script type="text/javascript" src="../extras/jquery.min.1.7.js"></script>
<script type="text/javascript" src="../../turn.min.js"></script>
<script type="text/javascript" src="underscore-min.js"></script>
<script type="text/javascript" src="loudonall.json"></script>
<style type="text/css">
body{
	background:#ccc;
}
#magazine{
	width:987px;
	height:600px;
	padding-bottom: 50px;
}
#magazine .turn-page{
	background-color:#ccc;
	background-size:100% 100%;
}
.controls{

}
</style>
</head>
<body>
<div id="magazine">
	<div style="background-image:url(pages/01.jpg);"></div>
	<div style="background-image:url(pages/02.jpg);"></div>
	<div style="background-image:url(pages/03.jpg);"></div>
	<div style="background-image:url(pages/04.jpg);"></div>
	<div style="background-image:url(pages/05.jpg);"></div>
	<div style="background-image:url(pages/06.jpg);"></div>
</div>

<div id="controls">
<textarea id="allJSON" rows=50 cols=80/></textarea>
<select id="show">

</select><br/></div>
<div id="pageCount"></div>
</body>
<script type="text/javascript">
	
	$(window).ready(function() {
	$("#magazine").empty();
	cols = _.map(loudon.response.docs,function(val,key){
		obj = {"id":val.mms_container_id,"name":val.container_name}
		return obj;
		
	});
	
	console.log(JSON.stringify(cols));
	cols = _.uniq(cols,false,function(val,key){
		return val.id;
	});;
	cols = _.sortBy(cols,function(val){
		return val.name;
	});
	text = ""
	_.each(cols,function(val,key){
		curid = val.id
		Show = _.filter(loudon.response.docs,function(s){
	
		return s.mms_container_id == curid;
		
		});
		sortedShow = _.sortBy(Show,function(n){
			return parseInt(n.sib_seq);
			});
		text=text+"{ \"name\":\""+val.name+"\", \"images\":[" ; 
		_.each(sortedShow,function(i,k){
		text=text+i.identifier_idx_local_image_id[0]+",";

		//$("#show").append("<option id='"+val.id+"'>"+val.name+"</option>");
	});
	text= text.substring(0,text.length-1)+"]},";

	});
	
		$("#allJSON").val(text);
	

	});

</script>


</html>
